# Enable kwm compatibility mode
khd kwm on

# Set border color for different modes
khd mode default color 0xff7dcbc4
khd mode resize color 0xddd75f5f
khd mode switcher color 0xddbdd322
khd mode launcher color 0xdd458588
khd mode margin color 0xddb16286
# khd mode swap color 0xdd458588
# khd mode tree color 0xddfabd2f
# khd mode info color 0xddcd950c
# khd mode ytd color 0xddd75f5f


# ==================
# Top level commands
# ==================

# Toggle between modes
# TODO: set timeout for all modes if no keys are pressed?

# Activate switcher mode; Exit switcher after 0.5 seconds
# TODO: test if hotkey has been pressed; then reset sleep timeout
ctrl + shift + cmd + alt - f	:   khd -e "mode activate switcher";\
				    sleep 1;\
				    [ $(khd -e "print mode") == "switcher" ] &&\
				    khd -e "mode activate default"

# Reload Khd config
switcher - e	: khd -e "reload";\
			          kwmc config reload;\
				  terminal-notifier \
				    -title "Kwm & Khd" \
				    -subtitle "Restarting at $(date '+%r')"

switcher - p	: source /$HOME/.kwm/scripts/pause-kwm.sh

## ------------
## Switch modes
## ------------

# resize window
switcher - s			:   khd -e "mode activate resize"
# manipulate margin around windows
switcher - m			:   khd -e "mode activate margin"
# switcher - a           	 :   khd -e "mode activate swap"
# switcher - q           	 :   khd -e "mode activate info"
# switcher - d           	 :   khd -e "mode activate tree"
# switcher - w           	 :   khd -e "mode activate ytd"

# return to all modes to  default with ESC key
switcher - 0x35			:   khd -e "mode activate default"
launcher - 0x35			:   khd -e "mode activate default"
margin   - 0x35			:   khd -e "mode activate default"
resize   - 0x35			:   khd -e "mode activate default"
# ytd + ctrl - 0x35		 :   khd -e "mode activate default"
# swap + ctrl - 0x35        	 :   khd -e "mode activate default"
# tree + ctrl - 0x35        	 :   khd -e "mode activate default"

## ------------------
## Manipulate Windows
## ------------------

# Rotate window-tree by 90* (clockwise)
ctrl + shift + cmd + alt - r	:   kwmc tree rotate 90


# TODO: change split-mode
# kwmc display -c {mode}
#     {mode}: optimal | vertical | horizontal

#TODO: difference between `kwmc space -t` and `kwmc config tiling [bsp | monocle | float ]` ?
# ctrl + shift + cmd + alt - a	:   kwmc space -t bsp
# ctrl + shift + cmd + alt - s	:   kwmc space -t monocle
# ctrl + shift + cmd + alt - d	:   kwmc space -t float

# window fullscreen keeps  bsp-tree intact
ctrl + shift + cmd + alt - s	:   kwmc window -z fullscreen
#TODO: set full up space of parent: kwmc window -z parent

# Move window focus
ctrl + shift + cmd + alt - h	:   kwmc window -f west
ctrl + shift + cmd + alt - l	:   kwmc window -f east
ctrl + shift + cmd + alt - j	:   kwmc window -f south
ctrl + shift + cmd + alt - k	:   kwmc window -f north
ctrl + shift + cmd + alt - n	:   kwmc window -f prev
ctrl + shift + cmd + alt - m	:   kwmc window -f next

# swap window locations
switcher - h	:   kwmc window -s west
switcher - j	:   kwmc window -s north
switcher - k	:   kwmc window -s south
switcher - l	:   kwmc window -s east

## -------------------
## Spaces and displays
## -------------------

# Move focues to next display
ctrl + shift + cmd + alt - o	:   kwmc display -f next

# swap window to other display
switcher - o	:   kwmc window -m display next


ctrl + shift + cmd + alt - 1	:   kwmc space -fExperimental 1
ctrl + shift + cmd + alt - 2	:   kwmc space -fExperimental 2
ctrl + shift + cmd + alt - 3	:   kwmc space -fExperimental 3
ctrl + shift + cmd + alt - 4    :   kwmc space -fExperimental 4

ctrl + shift + cmd + alt - z	:   kwmc spac -fExperimental left
ctrl + shift + cmd + alt - c    :   kwmc space -fExperimental right
ctrl + shift + cmd + alt - x    :   kwmc space -fExperimental previous

switcher - 1			:   kwmc window -m space 1;\
			            kwmc space -fExperimental 1;\
				    khd -e "mode active default"
switcher - 2			:   kwmc window -m space 2;\
			            kwmc space -fExperimental 2;\
			            khd -e "mode active default"
switcher - 3			:   kwmc window -m space 3;\
			            kwmc space -fExperimental 3;\
			            khd -e "mode active default"
switcher - 4			:   kwmc window -m space 4;\
			            kwmc space -fExperimental 4;\
			            khd -e "mode active default"

switcher - z			:   kwmc window -m space left;\
				    kwmc space -fExperimental left

switcher - c    		:   kwmc window -m space right;\
			            kwmc space -fExperimental right

# switcher + shift - 1    :   kwmc display -f 0
# switcher + shift - 2    :   kwmc display -f 1
# switcher + shift - 3    :   kwmc display -f 2


# ==============
# resize windows
# ==============

resize - h	    	:   kwmc window -c expand 0.05 west
resize - j		:   kwmc window -c expand 0.05 south
resize - k		:   kwmc window -c expand 0.05 north
resize - l		:   kwmc window -c expand 0.05 east

#TODO: query if window in corner; then resize key reduces in that direction
resize + shift - h   	:   kwmc window -c reduce 0.05 west
resize + shift - j	:   kwmc window -c reduce 0.05 south
resize + shift - k	:   kwmc window -c reduce 0.05 north
resize + shift - l	:   kwmc window -c reduce 0.05 east


# =========================
# launcher for applications
# =========================

switcher - return   :	khd -e "mode activate launcher"
launcher - return   :	open -a iTerm2.app; khd -e "mode activate default"
launcher - w	    :	open -a Safari.app; khd -e "mode activate default"

launcher - a	    :	kwmc space -fExperimental 2;\
		        open -a Adobe\ Illustrator.app; khd -e "mode activate default"

launcher - p	    :	kwmc space -fExperimental 2;\
                     	open -a Adobe\ Photoshop\ CS6.app; khd -e "mode activate default"

launcher - i	    :	kwmc space -fExperimental 2;\
                     	open -a Adobe\ InDesign\ CS6.app; khd -e "mode activate default"

launcher - g	    :	kwmc space -fExperimental 2;\
                     	open -a OmniGraffle.app; khd -e "mode activate default"



# # swap mode
# swap - h                :   kwmc window -s west
# swap - j                :   kwmc window -s south
# swap - k                :   kwmc window -s north
# swap - l                :   kwmc window -s east
# swap - m                :   kwmc window -s mark

# swap + shift - l        :   kwmc window -m east
# swap + shift - k        :   kwmc window -m north
# swap + shift - j        :   kwmc window -m south
# swap + shift - h        :   kwmc window -m west
# swap + shift - m        :   kwmc window -m mark

# swap - 1                :   kwmc window -m space 1
# swap - 2                :   kwmc window -m space 2
# swap - 3                :   kwmc window -m space 3
# swap - 4                :   kwmc window -m space 4
# swap - 5                :   kwmc window -m space 5

# swap - z                :   kwmc window -m space left
# swap - c                :   kwmc window -m space right

# swap + shift - 1        :   kwmc window -m display 0
# swap + shift - 2        :   kwmc window -m display 1
# swap + shift - 3        :   kwmc window -m display 2


# ==================
# Manipulate Margins
# ==================

# Inner margins
margin - x		:   kwmc space -g increase horizontal
margin - y		:   kwmc space -g increase vertical
margin - z		:   kwmc space -g increase all
margin + shift - x	:   kwmc space -g decrease horizontal
margin + shift - y	:   kwmc space -g decrease vertical
margin + shift - z	:   kwmc space -g decrease all

# Outer margins
margin - h		:   kwmc space -p increase left
margin - j	        :   kwmc space -p increase bottom
margin - k	        :   kwmc space -p increase top
margin - l	        :   kwmc space -p increase right
margin - p		:   kwmc space -p increase all

margin + shift - h	:   kwmc space -p decrease left
margin + shift - l	:   kwmc space -p decrease right
margin + shift - k	:   kwmc space -p decrease top
margin + shift - j	:   kwmc space -p decrease bottom
margin + shift - p	:   kwmc space -p decrease all


# =====================================
# Vi-mode for non-terminal applications
# =====================================

# # Remap left-control h/j/k/l -> arrow keys
# lctrl - h         ![Terminal,iTerm2] :   khd -p "- left"
# lctrl - j         ![Terminal,iTerm2] :   khd -p "- down"
# lctrl - k         ![Terminal,iTerm2] :   khd -p "- up"
# lctrl - l         ![Terminal,iTerm2] :   khd -p "- right"

# shift + lctrl - h ![Terminal,iTerm2] :   khd -p "shift - left"
# shift + lctrl - j ![Terminal,iTerm2] :   khd -p "shift - down"
# shift + lctrl - l ![Terminal,iTerm2] :   khd -p "shift - right"
# shift + lctrl - k ![Terminal,iTerm2] :   khd -p "shift - up"

# # Remap left-control 0 / 4 ---> start / end of line
# lctrl - 0         ![Terminal,iTerm2] :  khd -p "cmd - left"
# lctrl - 4         ![Terminal,iTerm2] :  khd -p "cmd - right"

# # Remap left-control g / G ---> start / end of text
# lctrl - g         ![Terminal,iTerm2] :  khd -p "cmd - up"
# lctrl + shift - g ![Terminal,iTerm2] :  khd -p "cmd - down"

# shift + lctrl - 0 ![Terminal,iTerm2] :  khd -p "shift + cmd - left"
# shift + lctrl - 4 ![Terminal,iTerm2] :  khd -p "shift + cmd - right"

# lctrl - b         ![Terminal,iTerm2] :  khd -p "alt - left"
# # Remap left-control b / e ---> start / end of word
# lctrl - e         ![Terminal,iTerm2] :  khd -p "alt - right"

# shift + lctrl - b ![Terminal,iTerm2] :  khd -p "shift + alt - left"
# shift + lctrl - e ![Terminal,iTerm2] :  khd -p "shift + alt - right"

# # Remap left-control x -------> forward delete
# lctrl - x         ![Terminal,iTerm2] :  khd -p "- delete"

# # Remap left-control u -------> undo typing
# lctrl - u         ![Terminal,iTerm2] :  khd -p "cmd - z"

# lctrl - n         ![Terminal,iTerm2] :  khd -p "cmd - z"


# Make search in Safari more like Vim
# ===================================
# lctrl + /	    --> open search
# lctrl + n	    --> next match
# lctrl + shift + n --> previous search
lctrl - 0x2C	    [Safari]	     :	khd -p "cmd - f"
# TODO: this doesn't work all the time
# lctrl - n	    [Safari]	     :	khd -p "return"
lctrl + shift - n   [Safari]	     :	khd -p "shift - return"


# TO REVIEW #######################################################

# # tree mode
# tree - f                :   kwmc window -z fullscreen
# tree - d                :   kwmc window -z parent
# tree - w                :   kwmc window -t focused
# tree - r                :   kwmc tree rotate 90

# tree - s                :   kwmc window -c split - mode toggle;\
#                             khd -e "mode activate default"

# tree - c                :   kwmc window -c type toggle;\
#                             khd -e "mode activate default"

# tree - h                :   kwmc window -c expand 0.05 west
# tree - j                :   kwmc window -c expand 0.05 south
# tree - k                :   kwmc window -c expand 0.05 north
# tree - l                :   kwmc window -c expand 0.05 east
# tree + shift - h        :   kwmc window -c reduce 0.05 west
# tree + shift - j        :   kwmc window -c reduce 0.05 south
# tree + shift - k        :   kwmc window -c reduce 0.05 north
# tree + shift - l        :   kwmc window -c reduce 0.05 east

# tree - p                :   kwmc tree -pseudo create
# tree + shift - p        :   kwmc tree -pseudo destroy

# tree - o                :   kwmc window -s prev
# tree + shift - o        :   kwmc window -s next



# # default
# cmd + alt + ctrl - m    :   kwmc window -mk focused
# cmd + alt + ctrl - h    :   kwmc window -mk west wrap
# cmd + alt + ctrl - l    :   kwmc window -mk east wrap
# cmd + alt + ctrl - j    :   kwmc window -mk south wrap
# cmd + alt + ctrl - k    :   kwmc window -mk north wrap

# cmd - 0x2A              :   khd -w "aasvi93@hotmail.com"
# cmd - 7                 :   khd -w "\\"
# cmd - 8                 :   khd -w "{"
# cmd - 9                 :   khd -w "}"


#
# # ytd mode
# # A simple local media-server for youtube
# # https://github.com/koekeishiya/ytd
#
# ytd - x                 :   ytc play;\
#                             khd -e "mode activate default"

# ytd - s                 :   ytc mkfav;\
#                             khd -e "mode activate default"

# # 0x32 == <
# ytd - 0x32              :   ytc fav
# ytd - z                 :   ytc prev
# ytd - c                 :   ytc next
# ytd - v                 :   ytc stop
# ytd - d                 :   ytc voldown
# ytd - a                 :   ytc volup
# ytd - right             :   ytc seekfw
# ytd - left              :   ytc seekbk
